function noNulls(n){return n!=null?n:""}function BRs(n){return n!==null?n+"<br />":""}function getInitials(n,t){let i="";return n.trim().length>=1&&(i+=n.trim().substr(0,1)),t.trim().length>=1&&(i+=t.trim().substr(0,1)),i}function hexColourFromName(n,t){let i="";return i+=n.trim().length>=1?n.trim().charCodeAt(0).toString(16):"00",t.trim().length>=2?(i+=t.trim().charCodeAt(0).toString(16),i+=t.trim().charCodeAt(1).toString(16)):t.trim().length>=1?(i+=t.trim().charCodeAt(0).toString(16),i+=t.trim().charCodeAt(0).toString(16)):i+="0000","#"+i}function hashCode(n){for(var t=0,i=0;i<n.length;i++)t=n.charCodeAt(i)+((t<<5)-t);return t}function intToRGB(n){var t=(n&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t}function checkApplyOrOkClicked(n){n.includes("OK")?$("#CloseFormOnSubmit").val("Y"):$("#CloseFormOnSubmit").val("N")}function attachListFunctions(n,t){if(t)$("#"+t).length>0?$("."+n).click(function(){var i=$(this).data("id"),n=$(this).data("loading-text");$("#"+t).val(i);n&&$("#FormTitleID").val(n)}):doErrorModal("Object ID is invalid","#"+t+" does not exist");else return!0;$(".dataList td").click(function(){var t=$(this).parent().parent().children().index($(this).parent()),n=$(this).parent().children().index($(this));showFilterAndSort(this,n)});$(".dataList td").contextmenu(function(){var t=$(this).parent().parent().children().index($(this).parent()),n=$(this).parent().children().index($(this));showFilterAndSort(this,n)})}function showFilterAndSort(n,t){var r,i,u,f,e;if(event.preventDefault(),$(".dataList").find("td").popover("hide"),r=$(n).find("a").attr("target"),r!==null){i=$(n).find("a").html().trim();u=$(n).find("a").attr("aria-label");$("#FilterCol").val(r);$("#FilterVal").val(i);$("#FilterTable").val(u);f=$("#FilterQuery").val();f===""?$(".ClearFilterControls").hide():$(".ClearFilterControls").show();e=new RegExp("^(?!0)Â£?[0-9.,]{1,}$");e.test(i)||isDate(i)?($(".NumberControls").show(),$(".TextControls .InfoNumber").show(),$(".TextControls .InfoText").hide()):($(".NumberControls").hide(),$(".TextControls .InfoNumber").hide(),$(".TextControls .InfoText").show());i.indexOf("check-box")>-1?$(".TextControls").hide():$(".TextControls").show();$(n).popover({trigger:"manual",html:!0,title:function(){return'Filter and Sort <span class="close">&times;<\/span>'},content:function(){return $("#FilterPanel").html()}}).popover("show");$(n).on("shown.bs.popover",function(i){var r=$("#"+$(i.target).attr("aria-describedby"));r.find(".close").click(function(){$(n).popover("hide")});attachFilterFunctions(t)})}}function attachFilterFunctions(n){$(".FilterButton").click(function(n){n.preventDefault();var t=$("#FilterCol").val(),i=$(this).attr("aria-label"),r=$("#FilterVal").val(),u=$("#FilterTable").val(),f=$("#FilterQuery").val();performFilteredSearch(t,i,r,u,f)});$(".DoFilterSearch").click(function(n){n.preventDefault();var t=$("#FilterCol").val(),i=$(this).attr("aria-label"),r=$(this).parent().parent().parent().find(".FilterSearch").val(),u=$("#FilterTable").val(),f=$("#FilterQuery").val();performFilteredSearch(t,i,r,u,f)});$(".FilterSearch").keypress(function(n){if(n.which===13){event.preventDefault();var t=$("#FilterCol").val(),i=$(this).val(),r=$("#FilterTable").val(),u=$("#FilterQuery").val();performFilteredSearch(t,"EQ",i,r,u)}});$(".SortButton").click(function(t){t.preventDefault();var f=$("#FilterCol").val(),r=$("#FilterTable").val(),i=$(this).attr("aria-label"),e=$("#SortQuery").val();$("#SortQuery").val(e+"!"+f+","+i);$("#"+r).find("td").popover("hide");i=i.toLowerCase();var u=$("#"+r),s=u.attr("aria-label"),o=u.DataTable();o.order([n,i]).draw();$(".SortApplied").show()})}function performFilteredSearch(n,t,i,r,u){var e;i.indexOf('checked="checked"')>-1?i="true":i.indexOf("check-box")>-1&&(i="false");i=i.replace(/[,]/gm,"|");i=i.replace(/[ ]/gm,"_");i=i.replace(".00","");i=i.replace(/[*]/gm,"%");i.indexOf("%")>-1&&(t="LK");i.indexOf("<=")>-1?t="LTE":i.indexOf(">=")>-1?t="GTE":i.indexOf("<")>-1?t="LT":i.indexOf(">")>-1&&(t="GT");i=i.replace("<=","");i=i.replace(">=","");i=i.replace("<","");i=i.replace(">","");$("#FilterComp").val(t);t==="X"?$("#FilterQuery").val(""):i?$("#FilterQuery").val(u+"!"+n+","+t+","+i):$("#FilterQuery").val(u+"!"+n+",NULL");var o=$("#FilterQuery").val(),f=$("#"+r),s=f.attr("aria-label");f.find("td").popover("hide");e=f.DataTable();e.ajax.url("/"+s+"/?handler=Json&search="+o).load(null,!1);$(".FilterApplied").show()}function loadList(n,t,i,r,u,f,e,o,s){var l,c,h;i||(i="Index");o||(o="1");s||(s="asc");l=r.length>0?"/"+t+"/"+i+"/"+r+f:"/"+t+"/"+i+"/"+f;c=$("#"+u).DataTable();h=r!=null?"/"+t+"/"+r+"/?handler=Json&search="+f:"/"+t+"/?handler=Json&search="+f;c.ajax.url(h).load(null,!1);console.log(h+" Loaded")}function loadInputForm(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var p,w;p=r.length>0?"/"+i+"/Edit/"+r+" #"+f:u.length>0?"/"+i+"/Create/"+u+" #"+f:"/"+i+"/Create/";w=$.get(p,function(w){var b=$(w).find("#"+f);$("#"+n).html(b);attachSubmitInputForm(n,t,i,r,u,e,o,s,h,c,l,a,v,y);console.log(p+" Loaded")});w.fail(function(){doErrorModal("Error Loading Form "+f,"The form at "+p+" returned a server error and could not be loaded")})}function loadDeleteForm(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var p,w;r.length>0?(p="/"+i+"/Delete/"+r+" #"+f,w=$.get(p,function(w){var b=$(w).find("#"+f);$("#"+n).html(b);attachSubmitDeleteForm(n,t,i,r,u,e,o,s,h,c,l,a,v,y);console.log(p+" Loaded")}),w.fail(function(){doErrorModal("Error Loading Form "+f,"The form at "+p+" returned a server error and could not be loaded")})):doErrorModal("Object ID not valid","Object ID does not have a valid value")}function attachSubmitInputForm(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=$("#"+f);return y.removeData("validator"),y.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(y),extraSubmitFormFunctions(),y.submit(function(n){n.preventDefault();r.length>0?y.valid()&&$.ajax({type:"POST",url:"/"+i+"/Edit/"+r,data:y.serialize(),success:function(){if(a===!0){$("#CloseFormOnSubmit").val()==="Y"&&$("#"+v).modal("hide");var n=new Audio("/sounds/confirm.wav");n.play()}loadList(t,i,"Index",u,e,o,s,h,c,l)},error:function(n){doCrashModal(n)}}):y.valid()&&$.ajax({type:"POST",url:"/"+i+"/Create",data:y.serialize(),success:function(n){var r=!1,f;a===!0&&($("#CloseFormOnSubmit").val()==="Y"&&(r=!0,$("#"+v).modal("hide")),f=new Audio("/sounds/confirm.wav"),f.play());r||($("#"+l).val(n.objectID),$("#"+v).trigger("shown.bs.modal"));loadList(t,i,"Index",u,e,o,s,h,c,l)},error:function(n){doCrashModal(n)}})}),y.valid()}function attachSubmitDeleteForm(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=$("#"+f);return y.removeData("validator"),y.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(y),y.submit(function(n){n.preventDefault();r.length>0?y.valid()&&$.ajax({type:"POST",url:"/"+i+"/Delete/"+r,data:y.serialize(),success:function(){a===!0&&$("#"+v).modal("hide");loadList(t,i,"Index",u,e,o,s,h,c,l)},error:function(n){doCrashModal(n)}}):doErrorModal("Object ID not valid","Object ID does not have a valid value")}),y.valid()}function getSearchParams(n){n||(n="");let t=new URLSearchParams(window.location.search);if(t.has("sort")){let i=t.get("sort");n+=n===""?"?sort="+i:"&sort="+i}if(t.has("search")){let i=t.get("search");n+=n===""?"?search="+i:"&search="+i}return n}function extraSubmitFormFunctions(){$(".ProfileIconAnimated").css({"margin-left":"-100px",borderSpacing:"-90"});$(".ProfileIconAnimated").animate({borderSpacing:90,marginLeft:"0px"},{step:function(n){$(this).css("transform","rotate("+n+"deg)")},duration:500},"linear")}function isDate(n){var t=new Date(n);return t.toString()==="Invalid Date"?!1:!0}$.ajaxSetup({cache:!1});var stringToColour=function(n){for(var r,u,i=0,t=0;t<n.length;t++)i=n.charCodeAt(t)+((i<<5)-i);for(r="#",t=0;t<3;t++)u=i>>t*8&255,r+=("00"+u.toString(16)).substr(-2);return r};$(".ClearSortButton").click(function(n){n.preventDefault();var t=$(this).attr("aria-label"),i=$("#"+t),r=i.DataTable();$("#SortQuery").val("");r.order.neutral().draw();$(".SortApplied").hide()});$(".ClearCurrentFiltersButton").click(function(n){var i;n.preventDefault();var r=$(this).attr("aria-label"),t=$("#"+r),u=t.attr("aria-label");$("#FilterQuery").val("");i=t.DataTable();i.ajax.url("/"+u+"/?handler=Json").load(null,!1);$(".FilterApplied").hide()});